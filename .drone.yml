pipeline:
  build-dev:
    image: plugins/docker
    repo: schvpn/website
    secrets: [ docker_username, docker_password ]
    tag: [ dev ]
    when:
      branch: dev

  build-prod:
    image: plugins/docker
    repo: schvpn/website
    secrets: [ docker_username, docker_password ]
    tag: [ master ]
    when:
      branch: master

  rancher:
    image: peloton/drone-rancher
    secrets: [ rancher_access_key, rancher_secret_key, rancher_url ]
    service: schoolvpn/website
    docker_image: schvpn/website
    confirm: true
    when:
      branch: master